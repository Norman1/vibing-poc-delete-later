<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plain Meaning Bible Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .book-selector {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .book-selector label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #495057;
        }

        .book-selector select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .book-selector select:focus {
            outline: none;
            border-color: #667eea;
        }

        .content {
            padding: 30px;
        }

        .book-title {
            font-size: 2.2em;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
        }

        .chapter {
            margin-bottom: 40px;
        }

        .chapter-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            padding: 10px 0;
            border-left: 4px solid #667eea;
            padding-left: 20px;
            background: rgba(102, 126, 234, 0.05);
        }

        .verse {
            margin-bottom: 15px;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #17a2b8;
            transition: all 0.3s ease;
        }

        .verse:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .verse-number {
            font-weight: bold;
            color: #667eea;
            margin-right: 10px;
            font-size: 0.9em;
        }

        .verse-text {
            display: inline;
            font-size: 1.1em;
            line-height: 1.7;
        }

        .note {
            display: block;
            margin-top: 8px;
            padding: 8px 12px;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            font-size: 0.9em;
            color: #856404;
            font-style: italic;
        }

        .note::before {
            content: "üìù ";
            margin-right: 5px;
        }

        .no-content {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
            font-size: 1.2em;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #6c757d;
            border-top: 1px solid #e9ecef;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Plain Meaning Bible</h1>
            <p>A meaning-driven translation using functional equivalence</p>
        </div>

        <div class="book-selector">
            <label for="bookSelect">Select a book to view:</label>
            <select id="bookSelect" onchange="loadBook()">
                <option value="">Choose a book...</option>
                <option value="genesis">Genesis</option>
                <option value="exodus">Exodus</option>
                <option value="leviticus">Leviticus</option>
                <option value="numbers">Numbers</option>
                <option value="deuteronomy">Deuteronomy</option>
                <option value="joshua">Joshua</option>
                <option value="judges">Judges</option>
                <option value="ruth">Ruth</option>
                <option value="1samuel">1 Samuel</option>
                <option value="2samuel">2 Samuel</option>
                <option value="1kings">1 Kings</option>
                <option value="2kings">2 Kings</option>
                <option value="1chronicles">1 Chronicles</option>
                <option value="2chronicles">2 Chronicles</option>
                <option value="ezra">Ezra</option>
                <option value="nehemiah">Nehemiah</option>
                <option value="esther">Esther</option>
                <option value="job">Job</option>
                <option value="psalms">Psalms</option>
                <option value="proverbs">Proverbs</option>
                <option value="ecclesiastes">Ecclesiastes</option>
                <option value="song">Song of Songs</option>
                <option value="isaiah">Isaiah</option>
                <option value="jeremiah">Jeremiah</option>
                <option value="lamentations">Lamentations</option>
                <option value="ezekiel">Ezekiel</option>
                <option value="daniel">Daniel</option>
                <option value="hosea">Hosea</option>
                <option value="joel">Joel</option>
                <option value="amos">Amos</option>
                <option value="obadiah">Obadiah</option>
                <option value="jonah">Jonah</option>
                <option value="micah">Micah</option>
                <option value="nahum">Nahum</option>
                <option value="habakkuk">Habakkuk</option>
                <option value="zephaniah">Zephaniah</option>
                <option value="haggai">Haggai</option>
                <option value="zechariah">Zechariah</option>
                <option value="malachi">Malachi</option>
                <option value="matthew">Matthew</option>
                <option value="mark">Mark</option>
                <option value="luke">Luke</option>
                <option value="john">John</option>
                <option value="acts">Acts</option>
                <option value="romans">Romans</option>
                <option value="1corinthians">1 Corinthians</option>
                <option value="2corinthians">2 Corinthians</option>
                <option value="galatians">Galatians</option>
                <option value="ephesians">Ephesians</option>
                <option value="philippians">Philippians</option>
                <option value="colossians">Colossians</option>
                <option value="1thessalonians">1 Thessalonians</option>
                <option value="2thessalonians">2 Thessalonians</option>
                <option value="1timothy">1 Timothy</option>
                <option value="2timothy">2 Timothy</option>
                <option value="titus">Titus</option>
                <option value="philemon">Philemon</option>
                <option value="hebrews">Hebrews</option>
                <option value="james">James</option>
                <option value="1peter">1 Peter</option>
                <option value="2peter">2 Peter</option>
                <option value="1john">1 John</option>
                <option value="2john">2 John</option>
                <option value="3john">3 John</option>
                <option value="jude">Jude</option>
                <option value="revelation">Revelation</option>
            </select>
        </div>

        <div class="content">
            <div id="book-content" class="no-content">
                Select a book from the dropdown above to view the translation.
            </div>
        </div>

        <div class="footer">
            <p>Public Domain ‚Ä¢ Functional Equivalence Translation</p>
        </div>
    </div>

    <script>
        const books = {
            'genesis': { title: 'Genesis', file: 'output/01_genesis_vbt.osis.xml' },
            'exodus': { title: 'Exodus', file: 'output/02_exodus_vbt.osis.xml' },
            'leviticus': { title: 'Leviticus', file: 'output/03_leviticus_vbt.osis.xml' },
            'numbers': { title: 'Numbers', file: 'output/04_numbers_vbt.osis.xml' },
            'deuteronomy': { title: 'Deuteronomy', file: 'output/05_deuteronomy_vbt.osis.xml' },
            'joshua': { title: 'Joshua', file: 'output/06_joshua_vbt.osis.xml' },
            'judges': { title: 'Judges', file: 'output/07_judges_vbt.osis.xml' },
            'ruth': { title: 'Ruth', file: 'output/08_ruth_vbt.osis.xml' },
            '1samuel': { title: '1 Samuel', file: 'output/09_1samuel_vbt.osis.xml' },
            '2samuel': { title: '2 Samuel', file: 'output/10_2samuel_vbt.osis.xml' },
            '1kings': { title: '1 Kings', file: 'output/11_1kings_vbt.osis.xml' },
            '2kings': { title: '2 Kings', file: 'output/12_2kings_vbt.osis.xml' },
            '1chronicles': { title: '1 Chronicles', file: 'output/13_1chronicles_vbt.osis.xml' },
            '2chronicles': { title: '2 Chronicles', file: 'output/14_2chronicles_vbt.osis.xml' },
            'ezra': { title: 'Ezra', file: 'output/15_ezra_vbt.osis.xml' },
            'nehemiah': { title: 'Nehemiah', file: 'output/16_nehemiah_vbt.osis.xml' },
            'esther': { title: 'Esther', file: 'output/17_esther_vbt.osis.xml' },
            'job': { title: 'Job', file: 'output/18_job_vbt.osis.xml' },
            'psalms': { title: 'Psalms', file: 'output/19_psalms_vbt.osis.xml' },
            'proverbs': { title: 'Proverbs', file: 'output/20_proverbs_vbt.osis.xml' },
            'ecclesiastes': { title: 'Ecclesiastes', file: 'output/21_ecclesiastes_vbt.osis.xml' },
            'song': { title: 'Song of Songs', file: 'output/22_song_vbt.osis.xml' },
            'isaiah': { title: 'Isaiah', file: 'output/23_isaiah_vbt.osis.xml' },
            'jeremiah': { title: 'Jeremiah', file: 'output/24_jeremiah_vbt.osis.xml' },
            'lamentations': { title: 'Lamentations', file: 'output/25_lamentations_vbt.osis.xml' },
            'ezekiel': { title: 'Ezekiel', file: 'output/26_ezekiel_vbt.osis.xml' },
            'daniel': { title: 'Daniel', file: 'output/27_daniel_vbt.osis.xml' },
            'hosea': { title: 'Hosea', file: 'output/28_hosea_vbt.osis.xml' },
            'joel': { title: 'Joel', file: 'output/29_joel_vbt.osis.xml' },
            'amos': { title: 'Amos', file: 'output/30_amos_vbt.osis.xml' },
            'obadiah': { title: 'Obadiah', file: 'output/31_obadiah_vbt.osis.xml' },
            'jonah': { title: 'Jonah', file: 'output/32_jonah_vbt.osis.xml' },
            'micah': { title: 'Micah', file: 'output/33_micah_vbt.osis.xml' },
            'nahum': { title: 'Nahum', file: 'output/34_nahum_vbt.osis.xml' },
            'habakkuk': { title: 'Habakkuk', file: 'output/35_habakkuk_vbt.osis.xml' },
            'zephaniah': { title: 'Zephaniah', file: 'output/36_zephaniah_vbt.osis.xml' },
            'haggai': { title: 'Haggai', file: 'output/37_haggai_vbt.osis.xml' },
            'zechariah': { title: 'Zechariah', file: 'output/38_zechariah_vbt.osis.xml' },
            'malachi': { title: 'Malachi', file: 'output/39_malachi_vbt.osis.xml' },
            'matthew': { title: 'Matthew', file: 'output/40_matthew_vbt.osis.xml' },
            'mark': { title: 'Mark', file: 'output/41_mark_vbt.osis.xml' },
            'luke': { title: 'Luke', file: 'output/42_luke_vbt.osis.xml' },
            'john': { title: 'John', file: 'output/43_john_vbt.osis.xml' },
            'acts': { title: 'Acts', file: 'output/44_acts_vbt.osis.xml' },
            'romans': { title: 'Romans', file: 'output/45_romans_vbt.osis.xml' },
            '1corinthians': { title: '1 Corinthians', file: 'output/46_1corinthians_vbt.osis.xml' },
            '2corinthians': { title: '2 Corinthians', file: 'output/47_2corinthians_vbt.osis.xml' },
            'galatians': { title: 'Galatians', file: 'output/48_galatians_vbt.osis.xml' },
            'ephesians': { title: 'Ephesians', file: 'output/49_ephesians_vbt.osis.xml' },
            'philippians': { title: 'Philippians', file: 'output/50_philippians_vbt.osis.xml' },
            'colossians': { title: 'Colossians', file: 'output/51_colossians_vbt.osis.xml' },
            '1thessalonians': { title: '1 Thessalonians', file: 'output/52_1thessalonians_vbt.osis.xml' },
            '2thessalonians': { title: '2 Thessalonians', file: 'output/53_2thessalonians_vbt.osis.xml' },
            '1timothy': { title: '1 Timothy', file: 'output/54_1timothy_vbt.osis.xml' },
            '2timothy': { title: '2 Timothy', file: 'output/55_2timothy_vbt.osis.xml' },
            'titus': { title: 'Titus', file: 'output/56_titus_vbt.osis.xml' },
            'philemon': { title: 'Philemon', file: 'output/57_philemon_vbt.osis.xml' },
            'hebrews': { title: 'Hebrews', file: 'output/58_hebrews_vbt.osis.xml' },
            'james': { title: 'James', file: 'output/59_james_vbt.osis.xml' },
            '1peter': { title: '1 Peter', file: 'output/60_1peter_vbt.osis.xml' },
            '2peter': { title: '2 Peter', file: 'output/61_2peter_vbt.osis.xml' },
            '1john': { title: '1 John', file: 'output/62_1john_vbt.osis.xml' },
            '2john': { title: '2 John', file: 'output/63_2john_vbt.osis.xml' },
            '3john': { title: '3 John', file: 'output/64_3john_vbt.osis.xml' },
            'jude': { title: 'Jude', file: 'output/65_jude_vbt.osis.xml' },
            'revelation': { title: 'Revelation', file: 'output/66_revelation_vbt.osis.xml' }
        };

        async function loadBook() {
            const select = document.getElementById('bookSelect');
            const content = document.getElementById('book-content');
            const selectedBook = select.value;

            if (!selectedBook) {
                content.innerHTML = '<div class="no-content">Select a book from the dropdown above to view the translation.</div>';
                return;
            }

            content.innerHTML = '<div class="no-content">Loading...</div>';

            try {
                const response = await fetch(books[selectedBook].file);
                if (!response.ok) {
                    throw new Error('File not found');
                }
                
                const xmlText = await response.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
                
                displayBook(xmlDoc, books[selectedBook].title);
            } catch (error) {
                content.innerHTML = `<div class="no-content">Error loading ${books[selectedBook].title}: ${error.message}</div>`;
            }
        }

        function displayBook(xmlDoc, bookTitle) {
            const content = document.getElementById('book-content');
            let html = `<div class="book-title">${bookTitle}</div>`;

            // Handle three different OSIS chapter formats:
            // 1. <div type="chapter"> (Daniel format)
            // 2. <chapter osisID="...">...</chapter> (Container format - Genesis 1-19)  
            // 3. <chapter osisID="..." sID="..."/>...<chapter eID="..."/> (Milestone format - Genesis 20+)
            
            // First, handle div type="chapter" format
            const divChapters = xmlDoc.querySelectorAll('div[type="chapter"]');
            
            if (divChapters.length > 0) {
                // Process div chapters
                divChapters.forEach(chapter => {
                    let chapterTitle = chapter.querySelector('title[type="chapter"]');
                    if (!chapterTitle) {
                        chapterTitle = chapter.querySelector('title');
                    }
                    
                    if (chapterTitle) {
                        html += `<div class="chapter">`;
                        html += `<div class="chapter-title">${chapterTitle.textContent}</div>`;
                    }

                    const verses = chapter.querySelectorAll('verse[osisID]');
                    verses.forEach(verse => {
                        const verseId = verse.getAttribute('osisID');
                        const verseNum = verseId.split('.').pop();
                        
                        html += `<div class="verse">`;
                        html += `<span class="verse-number">${verseNum}</span>`;
                        html += `<span class="verse-text">${verse.textContent}</span>`;
                        html += `</div>`;
                    });

                    html += `</div>`;
                });
            } else {
                // Handle both container and milestone chapter formats together
                // First process container chapters
                const containerChapters = xmlDoc.querySelectorAll('chapter[osisID]:not([sID]):not([eID])');
                
                containerChapters.forEach(chapter => {
                    const chapterNum = chapter.getAttribute('osisID').split('.').pop();
                    html += `<div class="chapter">`;
                    html += `<div class="chapter-title">Chapter ${chapterNum}</div>`;

                    const verses = chapter.querySelectorAll('verse[osisID]');
                    verses.forEach(verse => {
                        const verseId = verse.getAttribute('osisID');
                        const verseNum = verseId.split('.').pop();
                        
                        html += `<div class="verse">`;
                        html += `<span class="verse-number">${verseNum}</span>`;
                        html += `<span class="verse-text">${verse.textContent}</span>`;
                        html += `</div>`;
                    });

                    html += `</div>`;
                });
                
                // Then process milestone chapters
                const milestoneChapterStarts = xmlDoc.querySelectorAll('chapter[sID]');
                
                milestoneChapterStarts.forEach(chapterStart => {
                    const chapterId = chapterStart.getAttribute('osisID');
                    const chapterNum = chapterId.split('.').pop();
                    
                    html += `<div class="chapter">`;
                    html += `<div class="chapter-title">Chapter ${chapterNum}</div>`;
                    
                    // Find all verses between this sID and the matching eID
                    let currentNode = chapterStart.nextElementSibling;
                    
                    while (currentNode) {
                        // Check if we've reached the end marker for this chapter
                        if (currentNode.nodeName === 'chapter' && 
                            currentNode.getAttribute('eID') === chapterId) {
                            break;
                        }
                        
                        // Process verse elements
                        if (currentNode.nodeName === 'verse' && 
                            currentNode.getAttribute('osisID')) {
                            
                            const verseId = currentNode.getAttribute('osisID');
                            const verseNum = verseId.split('.').pop();
                            
                            html += `<div class="verse">`;
                            html += `<span class="verse-number">${verseNum}</span>`;
                            html += `<span class="verse-text">${currentNode.textContent}</span>`;
                            html += `</div>`;
                        }
                        
                        currentNode = currentNode.nextElementSibling;
                    }
                    
                    html += `</div>`;
                });
            }

            content.innerHTML = html;
        }
    </script>
</body>
</html>